
================================================================================
IM 后端 API 全面测试报告
================================================================================

测试概况
--------------------------------------------------------------------------------
测试开始时间: 2025-10-23 23:12:15
测试结束时间: 2025-10-23 23:12:18
总耗时: 2.977792667s
测试服务器: http://localhost:8080/api/v1

测试统计
--------------------------------------------------------------------------------
总测试数: 47
✓ 通过: 35 (74.5%)
✗ 失败: 12 (25.5%)
⊘ 跳过: 0 (0.0%)

模块测试详情
--------------------------------------------------------------------------------

【用户管理模块】
  测试数: 11 | 通过: 11 | 失败: 0 | 跳过: 0
  1. [✓] 健康检查 (耗时: 1.314ms)
  2. [✓] 密码注册-正常流程 (耗时: 82.166292ms)
  3. [✓] 密码注册-参数校验 (耗时: 1.753583ms)
  4. [✓] 密码注册-重复注册 (耗时: 53.999041ms)
  5. [✓] 密码登录-正常流程 (耗时: 96.72525ms)
  6. [✓] 密码登录-错误密码 (耗时: 95.445167ms)
  7. [✓] 密码登录-不存在的用户 (耗时: 1.441167ms)
  8. [✓] 获取个人信息-需要认证 (耗时: 1.349917ms)
  9. [✓] 获取个人信息-无Token (耗时: 116.667µs)
  10. [✓] 获取个人信息-错误Token (耗时: 121.291µs)
  11. [✓] 设置密码 (耗时: 100.037625ms)

【好友关系模块】
  测试数: 19 | 通过: 13 | 失败: 6 | 跳过: 0
  1. [✓] 搜索用户 (耗时: 2.174333ms)
  2. [✓] 发送好友请求 (耗时: 8.130666ms)
  3. [✗] 发送好友请求-参数校验 (耗时: 7.968333ms)
      错误: 2/3失败
  4. [✓] 获取收到的好友请求 (耗时: 1.392791ms)
  5. [✓] 获取发出的好友请求 (耗时: 2.024709ms)
  6. [✓] 获取好友列表 (耗时: 3.047125ms)
  7. [✗] 更新好友备注 (耗时: 2.16775ms)
      错误: code=500, msg=不是好友关系
  8. [✗] 删除好友 (耗时: 1.913041ms)
      错误: code=500, msg=不是好友关系
  9. [✓] 重复发送好友请求 (耗时: 10.0015ms)
  10. [✓] 搜索用户 (耗时: 2.202459ms)
  11. [✓] 发送好友请求 (耗时: 4.954375ms)
  12. [✗] 发送好友请求-参数校验 (耗时: 7.991625ms)
      错误: 2/3失败
  13. [✓] 获取收到的好友请求 (耗时: 1.018084ms)
  14. [✓] 获取发出的好友请求 (耗时: 1.233208ms)
  15. [✓] 获取好友列表 (耗时: 3.029042ms)
  16. [✗] 更新好友备注 (耗时: 2.854958ms)
      错误: code=500, msg=不是好友关系
  17. [✗] 删除好友 (耗时: 2.369375ms)
      错误: code=500, msg=不是好友关系
  18. [✓] 重复发送好友请求 (耗时: 9.521667ms)
  19. [✓] 发送给非好友 (耗时: 2.005792ms)

【朋友圈模块】
  测试数: 11 | 通过: 8 | 失败: 3 | 跳过: 0
  1. [✓] 发布朋友圈 (耗时: 5.833292ms)
  2. [✓] 发布朋友圈-参数校验 (耗时: 11.826083ms)
  3. [✓] 获取自己的朋友圈列表 (耗时: 5.700875ms)
  4. [✓] 获取朋友圈动态详情 (耗时: 4.609208ms)
  5. [✓] 获取朋友圈时间线 (耗时: 5.466792ms)
  6. [✗] 点赞朋友圈 (耗时: 2.99675ms)
      错误: code=500, msg=无权访问该动态
  7. [✗] 取消点赞 (耗时: 1.951708ms)
      错误: code=500, msg=未点赞过该动态
  8. [✓] 获取点赞列表 (耗时: 5.12625ms)
  9. [✗] 评论朋友圈 (耗时: 3.412542ms)
      错误: code=500, msg=无权访问该动态
  10. [✓] 获取评论列表 (耗时: 3.280333ms)
  11. [✓] 删除朋友圈 (耗时: 4.844ms)

【消息通信模块】
  测试数: 5 | 通过: 2 | 失败: 3 | 跳过: 0
  1. [✗] 创建会话 (耗时: 2.891583ms)
      错误: code=500, msg=只能与好友创建会话
  2. [✗] 发送文本消息 (耗时: 2.989625ms)
      错误: code=500, msg=只能给好友发送消息
  3. [✗] 发送消息-参数校验 (耗时: 4.843791ms)
      错误: 2/4失败
  4. [✓] 获取会话列表 (耗时: 3.931667ms)
  5. [✓] 获取未读消息总数 (耗时: 2.90825ms)

================================================================================
失败测试汇总
--------------------------------------------------------------------------------
1. 发送好友请求-参数校验
   错误: 2/3失败
2. 更新好友备注
   错误: code=500, msg=不是好友关系
3. 删除好友
   错误: code=500, msg=不是好友关系
4. 发送好友请求-参数校验
   错误: 2/3失败
5. 更新好友备注
   错误: code=500, msg=不是好友关系
6. 删除好友
   错误: code=500, msg=不是好友关系
7. 点赞朋友圈
   错误: code=500, msg=无权访问该动态
8. 取消点赞
   错误: code=500, msg=未点赞过该动态
9. 评论朋友圈
   错误: code=500, msg=无权访问该动态
10. 创建会话
   错误: code=500, msg=只能与好友创建会话
11. 发送文本消息
   错误: code=500, msg=只能给好友发送消息
12. 发送消息-参数校验
   错误: 2/4失败

================================================================================
性能分析
--------------------------------------------------------------------------------
平均响应时间: 12.460397ms

最慢的测试:
  1. 设置密码 - 100.037625ms
  2. 密码登录-正常流程 - 96.72525ms
  3. 密码登录-错误密码 - 95.445167ms
  4. 密码注册-正常流程 - 82.166292ms
  5. 密码注册-重复注册 - 53.999041ms

================================================================================
测试建议
--------------------------------------------------------------------------------
⚠ 发现 12 个失败的测试，建议检查以下内容：
  1. 检查数据库连接和数据完整性
  2. 检查Redis服务是否正常运行
  3. 检查JWT配置和Token生成
  4. 检查API参数校验逻辑
  5. 查看后端日志获取详细错误信息

================================================================================
测试覆盖范围
--------------------------------------------------------------------------------
本次测试覆盖了以下API端点：

【用户管理】
  ✓ POST /users/register-pwd - 密码注册
  ✓ POST /users/login-pwd - 密码登录
  ✓ GET  /users/me - 获取个人信息
  ✓ POST /users/logout - 登出
  ✓ POST /users/set-password - 设置密码
  ✓ GET  /ping - 健康检查

【好友关系】
  ✓ GET  /friends/search - 搜索用户
  ✓ POST /friends/send-request - 发送好友请求
  ✓ GET  /friends/received-requests - 获取收到的请求
  ✓ GET  /friends/sent-requests - 获取发出的请求
  ✓ POST /friends/accept-request - 接受好友请求
  ✓ POST /friends/reject-request - 拒绝好友请求
  ✓ GET  /friends/list - 获取好友列表
  ✓ PUT  /friends/update-remark - 更新好友备注
  ✓ DELETE /friends/{friend_id} - 删除好友

【朋友圈】
  ✓ POST /moments/create - 发布朋友圈
  ✓ GET  /moments/{id} - 获取动态详情
  ✓ GET  /moments/my-list - 获取自己的朋友圈
  ✓ GET  /moments/timeline - 获取朋友圈时间线
  ✓ POST /moments/{id}/like - 点赞
  ✓ DELETE /moments/{id}/unlike - 取消点赞
  ✓ GET  /moments/{id}/likes - 获取点赞列表
  ✓ POST /moments/{id}/comment - 评论
  ✓ GET  /moments/{id}/comments - 获取评论列表
  ✓ DELETE /moments/comments/{comment_id} - 删除评论
  ✓ DELETE /moments/{id} - 删除动态

【消息通信】
  ✓ POST /messages/conversations/create - 创建会话
  ✓ POST /messages/send - 发送消息
  ✓ GET  /messages/conversations - 获取会话列表
  ✓ GET  /messages/conversations/{id}/messages - 获取消息历史
  ✓ GET  /messages/unread-count - 获取未读消息数
  ✓ PUT  /messages/conversations/{id}/read - 标记已读
  ✓ PUT  /messages/{id}/recall - 撤回消息
  ✓ DELETE /messages/{id} - 删除消息

================================================================================
测试完成时间: 2025-10-23 23:12:18
================================================================================
