
================================================================================
IM 后端 API 全面测试报告
================================================================================

测试概况
--------------------------------------------------------------------------------
测试开始时间: 2025-10-23 21:55:48
测试结束时间: 2025-10-23 21:55:51
总耗时: 2.870233541s
测试服务器: http://localhost:8080/api/v1

测试统计
--------------------------------------------------------------------------------
总测试数: 40
✓ 通过: 28 (70.0%)
✗ 失败: 12 (30.0%)
⊘ 跳过: 0 (0.0%)

模块测试详情
--------------------------------------------------------------------------------

【用户管理模块】
  测试数: 11 | 通过: 11 | 失败: 0 | 跳过: 0
  1. [✓] 健康检查 (耗时: 1.48225ms)
  2. [✓] 密码注册-正常流程 (耗时: 75.96275ms)
  3. [✓] 密码注册-参数校验 (耗时: 3.118042ms)
  4. [✓] 密码注册-重复注册 (耗时: 52.951833ms)
  5. [✓] 密码登录-正常流程 (耗时: 99.323417ms)
  6. [✓] 密码登录-错误密码 (耗时: 98.2355ms)
  7. [✓] 密码登录-不存在的用户 (耗时: 1.348625ms)
  8. [✓] 获取个人信息-需要认证 (耗时: 2.363417ms)
  9. [✓] 获取个人信息-无Token (耗时: 130.458µs)
  10. [✓] 获取个人信息-错误Token (耗时: 82.25µs)
  11. [✓] 设置密码 (耗时: 103.037583ms)

【好友关系模块】
  测试数: 19 | 通过: 13 | 失败: 6 | 跳过: 0
  1. [✓] 搜索用户 (耗时: 1.462084ms)
  2. [✓] 发送好友请求 (耗时: 5.134917ms)
  3. [✗] 发送好友请求-参数校验 (耗时: 8.763625ms)
      错误: 2/3失败
  4. [✓] 获取收到的好友请求 (耗时: 730.083µs)
  5. [✓] 获取发出的好友请求 (耗时: 1.478709ms)
  6. [✓] 获取好友列表 (耗时: 3.276834ms)
  7. [✗] 更新好友备注 (耗时: 1.817334ms)
      错误: code=500, msg=不是好友关系
  8. [✗] 删除好友 (耗时: 2.145875ms)
      错误: code=500, msg=不是好友关系
  9. [✓] 重复发送好友请求 (耗时: 10.933042ms)
  10. [✓] 搜索用户 (耗时: 2.124084ms)
  11. [✓] 发送好友请求 (耗时: 4.716666ms)
  12. [✗] 发送好友请求-参数校验 (耗时: 9.536375ms)
      错误: 2/3失败
  13. [✓] 获取收到的好友请求 (耗时: 811.583µs)
  14. [✓] 获取发出的好友请求 (耗时: 1.699792ms)
  15. [✓] 获取好友列表 (耗时: 2.723959ms)
  16. [✗] 更新好友备注 (耗时: 1.811875ms)
      错误: code=500, msg=不是好友关系
  17. [✗] 删除好友 (耗时: 2.061417ms)
      错误: code=500, msg=不是好友关系
  18. [✓] 重复发送好友请求 (耗时: 10.814541ms)
  19. [✓] 发送给非好友 (耗时: 1.320583ms)

【朋友圈模块】
  测试数: 4 | 通过: 1 | 失败: 3 | 跳过: 0
  1. [✓] 发布朋友圈 (耗时: 2.32375ms)
  2. [✗] 发布朋友圈-参数校验 (耗时: 5.96525ms)
      错误: 1/4失败
  3. [✗] 获取自己的朋友圈列表 (耗时: 412.875µs)
      错误: code=400, msg=动态ID格式错误
  4. [✗] 获取朋友圈时间线 (耗时: 415.125µs)
      错误: code=400, msg=动态ID格式错误

【消息通信模块】
  测试数: 5 | 通过: 2 | 失败: 3 | 跳过: 0
  1. [✗] 创建会话 (耗时: 1.428958ms)
      错误: code=500, msg=只能与好友创建会话
  2. [✗] 发送文本消息 (耗时: 999.208µs)
      错误: code=500, msg=只能给好友发送消息
  3. [✗] 发送消息-参数校验 (耗时: 3.047083ms)
      错误: 2/4失败
  4. [✓] 获取会话列表 (耗时: 1.360625ms)
  5. [✓] 获取未读消息总数 (耗时: 2.370291ms)

================================================================================
失败测试汇总
--------------------------------------------------------------------------------
1. 发送好友请求-参数校验
   错误: 2/3失败
2. 更新好友备注
   错误: code=500, msg=不是好友关系
3. 删除好友
   错误: code=500, msg=不是好友关系
4. 发送好友请求-参数校验
   错误: 2/3失败
5. 更新好友备注
   错误: code=500, msg=不是好友关系
6. 删除好友
   错误: code=500, msg=不是好友关系
7. 发布朋友圈-参数校验
   错误: 1/4失败
8. 获取自己的朋友圈列表
   错误: code=400, msg=动态ID格式错误
9. 获取朋友圈时间线
   错误: code=400, msg=动态ID格式错误
10. 创建会话
   错误: code=500, msg=只能与好友创建会话
11. 发送文本消息
   错误: code=500, msg=只能给好友发送消息
12. 发送消息-参数校验
   错误: 2/4失败

================================================================================
性能分析
--------------------------------------------------------------------------------
平均响应时间: 13.272117ms

最慢的测试:
  1. 设置密码 - 103.037583ms
  2. 密码登录-正常流程 - 99.323417ms
  3. 密码登录-错误密码 - 98.2355ms
  4. 密码注册-正常流程 - 75.96275ms
  5. 密码注册-重复注册 - 52.951833ms

================================================================================
测试建议
--------------------------------------------------------------------------------
⚠ 发现 12 个失败的测试，建议检查以下内容：
  1. 检查数据库连接和数据完整性
  2. 检查Redis服务是否正常运行
  3. 检查JWT配置和Token生成
  4. 检查API参数校验逻辑
  5. 查看后端日志获取详细错误信息

================================================================================
测试覆盖范围
--------------------------------------------------------------------------------
本次测试覆盖了以下API端点：

【用户管理】
  ✓ POST /users/register-pwd - 密码注册
  ✓ POST /users/login-pwd - 密码登录
  ✓ GET  /users/me - 获取个人信息
  ✓ POST /users/logout - 登出
  ✓ POST /users/set-password - 设置密码
  ✓ GET  /ping - 健康检查

【好友关系】
  ✓ GET  /friends/search - 搜索用户
  ✓ POST /friends/send-request - 发送好友请求
  ✓ GET  /friends/received-requests - 获取收到的请求
  ✓ GET  /friends/sent-requests - 获取发出的请求
  ✓ POST /friends/accept-request - 接受好友请求
  ✓ POST /friends/reject-request - 拒绝好友请求
  ✓ GET  /friends/list - 获取好友列表
  ✓ PUT  /friends/update-remark - 更新好友备注
  ✓ DELETE /friends/{friend_id} - 删除好友

【朋友圈】
  ✓ POST /moments/create - 发布朋友圈
  ✓ GET  /moments/{id} - 获取动态详情
  ✓ GET  /moments/my-list - 获取自己的朋友圈
  ✓ GET  /moments/timeline - 获取朋友圈时间线
  ✓ POST /moments/{id}/like - 点赞
  ✓ DELETE /moments/{id}/unlike - 取消点赞
  ✓ GET  /moments/{id}/likes - 获取点赞列表
  ✓ POST /moments/{id}/comment - 评论
  ✓ GET  /moments/{id}/comments - 获取评论列表
  ✓ DELETE /moments/comments/{comment_id} - 删除评论
  ✓ DELETE /moments/{id} - 删除动态

【消息通信】
  ✓ POST /messages/conversations/create - 创建会话
  ✓ POST /messages/send - 发送消息
  ✓ GET  /messages/conversations - 获取会话列表
  ✓ GET  /messages/conversations/{id}/messages - 获取消息历史
  ✓ GET  /messages/unread-count - 获取未读消息数
  ✓ PUT  /messages/conversations/{id}/read - 标记已读
  ✓ PUT  /messages/{id}/recall - 撤回消息
  ✓ DELETE /messages/{id} - 删除消息

================================================================================
测试完成时间: 2025-10-23 21:55:51
================================================================================
